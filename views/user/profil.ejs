<%-include('head.ejs')%>
<input type="hidden" value="<%=haserrorprofil%>" id="haserrorprofil">
<div class="d-flex bd-highlight">
  <div class="p-4 flex-grow-1 bd-highlight"><a class="navbar-brand" href="/">Shop24</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button></div>
  <div class="p-2 bd-highlight"><nav class="navbar navbar-expand-lg ">
  

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <div class="container">
        <ul class="nav nav-tabs mr-auto">
  
          <%if(!check){%>
          <li class="nav-item">
            <a class="nav-link" href="/users/signup"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-house-door" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z"/>
              <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
            </svg> Compte</a>
          </li>
          <% } else{ %>
          <li class="nav-item">
            <a class="nav-link" href="/panier"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart4" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l.5 2H5V5H3.14zM6 5v2h2V5H6zm3 0v2h2V5H9zm3 0v2h1.36l.5-2H12zm1.11 3H12v2h.61l.5-2zM11 8H9v2h2V8zM8 8H6v2h2V8zM5 8H3.89l.5 2H5V8zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"/>
            </svg> Panier <b class="badge badge-dark"><%=QPr%></b></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/users/profil"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-person" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M10 5a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm6 5c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
            </svg> Profil</a>
          </li>
          <li>
            <a class="nav-link" href="/users/logout"><button class="btn btn-primary" > <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-forward-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.77 12.11l4.012-2.953a.647.647 0 0 0 0-1.114L9.771 5.09a.644.644 0 0 0-.971.557V6.65H2v3.9h6.8v1.003c0 .505.545.808.97.557z"/>
            </svg>  Déconnexion</button>       </a>    </li>
          <%}%>
    </ul>
  </div>
  </div>
  </nav></div>
</div>
<div class="container">
  <h1>Profil</h1>
    <h2 style="color: cornflowerblue;"><center><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-person-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm-1 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm-3 4c2.623 0 4.146.826 5 1.755V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-1.245C3.854 11.825 5.377 11 8 11z"/>
    </svg> <%=user.userName%></center></h2>
  
  <div class="row">
    <div class="col-sm-2">
      <div class="text-center">
  
      </div>
      <br> <br>
    </div>
    <div class="col-sm-9">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
            aria-selected="true">Acceuil</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
            aria-selected="false">Commandes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact"
            aria-selected="false">Modifier</a>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
          <div class="container">
            <div class="row" id="rowhome">
              <div class="col-6 col-sm-3">
                <p class="font-weight-bold">Nom</p>
              </div>
  
              <%if(user.userName){%>
                <div class="col-6 col-sm-6">
                <p class="font-weight-normal"><%=user.userName%></p>
              </div>
              <%}else{%>
              <div class="col-6 col-sm-6">
                <p class="font-weight-normal">saisir votre nom</p>
              </div>
              <%}%>
  
  
              <div class="w-100"></div>
  
              <div class="col-6 col-sm-3">
                <p class="font-weight-bold">Email</p>
              </div>
              <div class="col-6 col-sm-6">
                <p class="font-weight-normal"><%=user.email%></p>
              </div>
  
              <div class="w-100"></div>
  
              <div class="col-6 col-sm-3">
                <p class="font-weight-bold">Numéro</p>
              </div>
            <%if(user.contact){%>
              <div class="col-6 col-sm-6">
                <p class="font-weight-normal"><%=user.contact%></p>
              </div>
              <%}else{%>
                <div class="col-6 col-sm-6">
                  <p class="font-weight-normal">saisir votre numéro</p>
                </div>
                <%}%>
    
  
              <div class="w-100"></div>
  
              <div class="col-6 col-sm-3">
                <p class="font-weight-bold">Adresse</p>
              </div>
              <%if(user.address){%>
              <div class="col-6 col-sm-6">
                <p class="font-weight-normal"><%=user.address%></p>
              </div>
              <%}else{%>
                <div class="col-6 col-sm-6">
                  <p class="font-weight-normal">saisir votre Adresse</p>
                </div>
                <%}%>
    
              <div class="w-100"></div>
  
              <div class="col-6 col-sm-3">
                <p class="font-weight-bold">Mot de passe</p>
              </div>
              <div class="col-6 col-sm-3">
                <p class="font-weight-normal">********</p>
              </div>
            </div>
  
  
  
  
           
          </div>
  
  
  
        </div>
        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
          <div style="padding-top: 30px">
            <% var index = 1 %>
            <% for(var i of order){%>
            <table class="table table-bordered">
              <thead>
                <tr class="table-active text-cenetr">
  
                  <td colspan="4" style="font-weight: bold" class="text-center "> Commande numero <%=index++%></td>
                </tr>
                <tr>
                  <th scope="col" class="text-center ">#</th>
                  <th scope="col" class="text-center ">Nom Produits</th>
                  <th scope="col" class="text-center ">Prix Produits</th>
                </tr>
              </thead>
              <tbody>
  <%var indexProduct = 1 %>
  <% for(var x of i.cart.Produits){%>
    <tr>
                  <th scope="row" class="text-center "><%=indexProduct++%></th>
                  <td class="text-center "><%=x.nom%></td>
                  <td class="text-center "><%=x.prix%> DT</td>
                 
                </tr>
               
  
                <%}%>
                <td> <%=i.cart.createAt%></td>
                <tr class="table-primary">
                  <td colspan="3" style="font-weight: bold">Prix Total</td>
                  <td style="font-weight: bold" class="text-center "> <%=i.TotalPrix%> DT</td>
                </tr>
              </tbody>
            </table>
  
  <%}%>
          </div>
        </div>
        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
           <form id="" class="" method="post" action="updateuser" style="margin-top: 30px;">
          <%for(var errorr of error){%>
          <div class="alert alert-danger">
            <p><%=errorr%></p>
          </div>
  
          <%}%>
          <div class="form-group">
            <label for="UserName">Nom</label>
            <input type="text" class="form-control" placeholder="saisir votre Nom" name="username">
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="text" class="form-control" placeholder="saisir votre Email" name="email">
          </div>
          <div class="form-group">
            <label for="Contact">Numéro</label>
            <input type="text" class="form-control" placeholder="saisir votre numero de telephone" name="contact">
          </div>
          <div class="form-group">
            <label for="Adress">Adresse</label>
            <input type="text" class="form-control" placeholder="saisir votre Adresse" name="address">
          </div>
          <div class="form-group">
            <label for="password">Mot de passe</label>
            <input type="text" class="form-control" placeholder="saisir votre Mot de passe" name="password">
          </div>
          <div class="text-center">
            <input type="hidden" name="_csrf" value="<%=token%>">
            <button type="submit" class="btn btn-success">Modifier</button>
            <a href="/users/profil" class="btn btn-danger">Retour</a>
          </div>
        </form>
  </div>
      </div>
    </div>
  </div>
</div>



<script>
  console.log(document.getElementById('hasMassagesError').value)
  if (document.getElementById('hasMassagesError').value === "true") {
    $('#rowhome').addClass('d-none');
    $('#formupdate').removeClass('d-none')
  }
  document.getElementById('file').onchange = function () {
    const reader = new FileReader();
    reader.onload = function () {
      document.getElementById('image').src = this.result;
    }
    reader.readAsDataURL(this.files[0]);
    $('#file').addClass('d-none');
    $('#actionbutton').removeClass();
  }
  document.getElementById('updatedata').onclick = function () {
    $('#rowhome').addClass('d-none');
    $('#formupdate').removeClass('d-none')
  }
</script>